<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Bootstrap demo</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body class="">
	<div class="container py-4">
		<!-- Status / Header box -->
		<div class="card shadow mb-4">
			<div class="card-body">
				<div class="d-flex flex-wrap gap-3 align-items-center">
					<div><strong>Mode:</strong> {{ mode_label }}</div>
					<div><strong>Progress:</strong> {{ mastered }}/{{ total }}</div>
					<div class="text-muted small">(Need {{ req }} correct in a row)</div>
					<div class="text-muted small">Auto-speak after submit: ON</div>
				</div>
			</div>
		</div>

		<!-- Controls -->
		<div class="d-flex flex-wrap gap-2 align-items-center mb-4">
			<button type="button" class="btn btn-primary" onclick="speakWord()"> <i class="bi bi-volume-down-fill"></i>
				Speak</button>
			<button type="button" class="btn btn-outline-secondary" onclick="toggleShowMeaning()"> Meaning </button>
			<div class="vr mx-1"></div>
			<a class="btn btn-link px-0" href="/?mode=ordered&start=1">Ordered</a>
			<a class="btn btn-link px-0" href="/?mode=random">Random</a>
			<a class="small" href="/?mode=mistakes">Mistakes Only</a>
		</div>

		<!-- Form -->
		<form method="POST" action="/answer" class="p-4 border rounded shadow">
			<label for="basic-url" class="form-label">English Spelling Trainer <i class="bi bi-journal-check"></i>
			</label>
			<div class="input-group mb-3">
				<input id="answerInput" type="text" name="answer" class="form-control" autofocus autocomplete="off"
					placeholder="Type the word..." />
				<button class="btn btn-success shadow" type="submit" id="button-addon2">Submit</button>
			</div>
			<div class="form-text">
				{% if message %}
				{{ message|safe }}
				{% endif %}
				{{meaning}}
			</div>
		</form>
		<div class="mt-4 p-3 border rounded bg-light shadow">
			<b>Top Misspelled Words | {{ misspelled_words_count }}</b>

			{% if top_mistakes and top_mistakes|length > 0 %}
			<ol class="mt-2 mb-0">
				{% for item in top_mistakes %}
				<li><b>{{ item.word }}</b> â€” {{ item.mistakes }} mistake(s)</li>
				{% endfor %}

			</ol>
			{% else %}
			<div class="text-muted mt-2">No mistakes yet. âœ…</div>
			{% endif %}
		</div>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
		crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
		integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
		crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.min.js"
		integrity="sha384-G/EV+4j2dNv+tEPo3++6LCgdCROaejBqfUeNjuKAiuXbjrxilcCdDz6ZAVfHWe1Y"
		crossorigin="anonymous"></script>

	<script>
		function speakWord() {
			const word = "{{ word }}";
			if (!window.speechSynthesis) {
				alert("SpeechSynthesis is not supported in this browser.");
				return;
			}
			const u = new SpeechSynthesisUtterance(word);
			u.lang = "en-US";
			u.rate = 0.5;   // ðŸ‘ˆ slow down here
			u.pitch = 1.0;
			u.volume = 1.0;

			window.speechSynthesis.cancel();
			window.speechSynthesis.speak(u);
		}

		function toggleShowMeaning() {
			const box = document.getElementById("meaningBox");
			box.style.display = (box.style.display === "none") ? "block" : "none";
		}

		document.addEventListener("DOMContentLoaded", () => {
			const inp = document.getElementById("answerInput");
			if (inp) inp.focus();

			const word = "{{ word }}";
			if (word && word.trim().length > 0) {
				speakWord();
			}
		});
	</script>
</body>

</html>