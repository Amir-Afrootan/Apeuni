<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Bootstrap demo</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
</head>

<body>
	<div class="container py-4">
		<h2 class="display-6 mb-4">English Spelling Trainer</h2>

		<!-- Status / Header box -->
		<div class="card shadow mb-4">
			<div class="card-body">
				<div class="d-flex flex-wrap gap-3 align-items-center">
					<div><strong>Mode:</strong> {{ mode_label }}</div>
					<div><strong>Progress:</strong> {{ mastered }}/{{ total }}</div>
					<div class="text-muted small">(Need {{ req }} correct in a row)</div>
					<div class="text-muted small">Auto-speak after submit: ON</div>
				</div>
			</div>
		</div>

		<!-- Controls -->
		<div class="d-flex flex-wrap gap-2 align-items-center mb-4">
			<button type="button" class="btn btn-primary" onclick="speakWord()">ðŸ”Š Speak</button>

			<button type="button" class="btn btn-outline-secondary" onclick="toggleShowMeaning()"> Meaning </button>

			<div class="vr mx-1"></div>

			<a class="btn btn-link px-0" href="/?mode=ordered">Ordered</a>
			<a class="btn btn-link px-0" href="/?mode=random">Random</a>
		</div>

		<!-- Form -->
		<form method="POST" action="/answer" class="p-4 rounded shadow">
			<div class="input-group mb-3">
				<input id="answerInput" type="text" name="answer" class="form-control" autofocus autocomplete="off" placeholder="Type the word..." />
				<button class="btn btn-success shadow" type="submit" id="button-addon2">Submit</button>
			</div>
			<div class="form-text">
				{% if message %}
				<div class="mt-2"> {{ message|safe }} </div>
				{% endif %}
				<!-- <strong>Meaning:</strong> {{ meaning }} -->
			</div>


		</form>


	</div>






	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
		crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
		integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
		crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.min.js"
		integrity="sha384-G/EV+4j2dNv+tEPo3++6LCgdCROaejBqfUeNjuKAiuXbjrxilcCdDz6ZAVfHWe1Y"
		crossorigin="anonymous"></script>



	<script>
		function speakWord() {
			const word = "{{ word }}";
			if (!window.speechSynthesis) {
				alert("SpeechSynthesis is not supported in this browser.");
				return;
			}
			const u = new SpeechSynthesisUtterance(word);
			u.lang = "en-US";
			u.rate = 0.5;   // ðŸ‘ˆ slow down here
			u.pitch = 1.0;
			u.volume = 1.0;

			window.speechSynthesis.cancel();
			window.speechSynthesis.speak(u);
		}

		function toggleShowMeaning() {
			const box = document.getElementById("meaningBox");
			box.style.display = (box.style.display === "none") ? "block" : "none";
		}

		document.addEventListener("DOMContentLoaded", () => {
			// Keep focus on input after every refresh
			const inp = document.getElementById("answerInput");
			if (inp) inp.focus();

			// Auto speak AFTER submit
			const autoplay = {{ autoplay | tojson
		}};
		if (autoplay) {
			speakWord();
		}
  });
	</script>
</body>

</html>